{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Outlet}from\"react-router-dom\";import{useState,useEffect}from\"react\";import useRefreshToken from'../hooks/useRefreshToken';import useAuth from'../hooks/useAuth';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PersistLogin=function PersistLogin(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var refresh=useRefreshToken();var _useAuth=useAuth(),auth=_useAuth.auth,persist=_useAuth.persist,logOutTimer=_useAuth.logOutTimer;console.log(persist);useEffect(function(){var isMounted=true;var verifyRefreshToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return refresh();case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 8:_context.prev=8;isMounted&&setIsLoading(false);return _context.finish(8);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,5,8,11]]);}));return function verifyRefreshToken(){return _ref.apply(this,arguments);};}();!(auth!==null&&auth!==void 0&&auth.accessToken)||!persist?verifyRefreshToken():setIsLoading(false);return function(){return isMounted=false;};},[]);useEffect(function(){console.log(\"isLoading: \".concat(isLoading));console.log(\"aT: \".concat(JSON.stringify(auth===null||auth===void 0?void 0:auth.accessToken)));},[isLoading]);return/*#__PURE__*/_jsx(_Fragment,{children:!persist?/*#__PURE__*/_jsx(Outlet,{}):isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):/*#__PURE__*/_jsx(Outlet,{})});};export default PersistLogin;","map":{"version":3,"names":["Outlet","useState","useEffect","useRefreshToken","useAuth","PersistLogin","isLoading","setIsLoading","refresh","auth","persist","logOutTimer","console","log","isMounted","verifyRefreshToken","error","accessToken","JSON","stringify"],"sources":["/Users/alirahmani/Project/blog_project/src/Components/PersistLogin.js"],"sourcesContent":["import { Outlet } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport useRefreshToken from '../hooks/useRefreshToken';\nimport useAuth from '../hooks/useAuth';\n\nconst PersistLogin = () => {\n    const [isLoading, setIsLoading] = useState(true);\n    const refresh = useRefreshToken();\n    const { auth, persist,logOutTimer } = useAuth();\n    console.log(persist)\n   \n    useEffect(() => {\n        let isMounted = true;\n\n        const verifyRefreshToken = async () => {\n            try {\n                await refresh()\n                \n            }\n            catch (err) {\n                console.error(err);\n            }\n            finally {\n                isMounted && setIsLoading(false);\n            }\n        }\n\n        \n        !auth?.accessToken || !persist ? verifyRefreshToken() : setIsLoading(false);\n\n        return () => isMounted = false;\n    }, [])\n    \n    useEffect(() => {\n        console.log(`isLoading: ${isLoading}`)\n        console.log(`aT: ${JSON.stringify(auth?.accessToken)}`)\n    }, [isLoading])\n\n    return (\n        <>\n            {!persist\n                ? <Outlet />\n                : isLoading\n                    ? <p>Loading...</p>\n                    : <Outlet />\n            }\n        </>\n    )\n}\n\nexport default PersistLogin"],"mappings":"oYAAA,OAASA,MAAT,KAAuB,kBAAvB,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,gBAAP,KAA4B,0BAA5B,CACA,MAAOC,QAAP,KAAoB,kBAApB,C,gGAEA,GAAMC,aAAY,CAAG,QAAfA,aAAe,EAAM,CACvB,cAAkCJ,QAAQ,CAAC,IAAD,CAA1C,wCAAOK,SAAP,eAAkBC,YAAlB,eACA,GAAMC,QAAO,CAAGL,eAAe,EAA/B,CACA,aAAsCC,OAAO,EAA7C,CAAQK,IAAR,UAAQA,IAAR,CAAcC,OAAd,UAAcA,OAAd,CAAsBC,WAAtB,UAAsBA,WAAtB,CACAC,OAAO,CAACC,GAAR,CAAYH,OAAZ,EAEAR,SAAS,CAAC,UAAM,CACZ,GAAIY,UAAS,CAAG,IAAhB,CAEA,GAAMC,mBAAkB,4FAAG,2KAEbP,QAAO,EAFM,sFAMnBI,OAAO,CAACI,KAAR,cANmB,uBASnBF,SAAS,EAAIP,YAAY,CAAC,KAAD,CAAzB,CATmB,mGAAH,kBAAlBQ,mBAAkB,0CAAxB,CAcA,EAACN,IAAD,SAACA,IAAD,WAACA,IAAI,CAAEQ,WAAP,GAAsB,CAACP,OAAvB,CAAiCK,kBAAkB,EAAnD,CAAwDR,YAAY,CAAC,KAAD,CAApE,CAEA,MAAO,kBAAMO,UAAS,CAAG,KAAlB,EAAP,CACH,CApBQ,CAoBN,EApBM,CAAT,CAsBAZ,SAAS,CAAC,UAAM,CACZU,OAAO,CAACC,GAAR,sBAA0BP,SAA1B,GACAM,OAAO,CAACC,GAAR,eAAmBK,IAAI,CAACC,SAAL,CAAeV,IAAf,SAAeA,IAAf,iBAAeA,IAAI,CAAEQ,WAArB,CAAnB,GACH,CAHQ,CAGN,CAACX,SAAD,CAHM,CAAT,CAKA,mBACI,yBACK,CAACI,OAAD,cACK,KAAC,MAAD,IADL,CAEKJ,SAAS,cACL,iCADK,cAEL,KAAC,MAAD,IALd,EADJ,CAUH,CA3CD,CA6CA,cAAeD,aAAf"},"metadata":{},"sourceType":"module"}