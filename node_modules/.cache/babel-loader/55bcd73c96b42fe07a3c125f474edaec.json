{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/alirahmani/Project/blog_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from'../Controllers/axios';import useAuth from'./useAuth';var useRefreshToken=function useRefreshToken(){var _useAuth=useAuth(),auth=_useAuth.auth,setAuth=_useAuth.setAuth;var refresh=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/refresh',{headers:{'Content-Type':'application/json','Authorization':'Bearer '+auth.accessToken},withCredentials:true});case 2:response=_context.sent;setAuth(function(prev){console.log(JSON.stringify(prev));console.log('inside use refresh token',response.data.accessToken);return _objectSpread(_objectSpread({},prev),{},{roles:response.data.roles,accessToken:response.data.accessToken});});return _context.abrupt(\"return\",response.data.accessToken);case 5:case\"end\":return _context.stop();}}},_callee);}));return function refresh(){return _ref.apply(this,arguments);};}();return refresh;};export default useRefreshToken;","map":{"version":3,"names":["axios","useAuth","useRefreshToken","auth","setAuth","refresh","get","headers","accessToken","withCredentials","response","prev","console","log","JSON","stringify","data","roles"],"sources":["/Users/alirahmani/Project/blog_project/src/hooks/useRefreshToken.js"],"sourcesContent":["import axios from '../Controllers/axios';\nimport useAuth from './useAuth';\n\nconst useRefreshToken = () => {\n    const { auth,setAuth } = useAuth();\n\n    const refresh = async () => {\n        const response = await axios.get('/api/refresh', {\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': 'Bearer ' + auth.accessToken\n            },\n            withCredentials: true\n        });\n        setAuth(prev => {\n            console.log(JSON.stringify(prev));\n            console.log('inside use refresh token',response.data.accessToken);\n            return {\n                ...prev,\n                roles: response.data.roles,\n                accessToken: response.data.accessToken\n            }\n        });\n        return response.data.accessToken;\n    }\n    return refresh;\n};\n\nexport default useRefreshToken;\n"],"mappings":"mYAAA,MAAOA,MAAP,KAAkB,sBAAlB,CACA,MAAOC,QAAP,KAAoB,WAApB,CAEA,GAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,EAAM,CAC1B,aAAyBD,OAAO,EAAhC,CAAQE,IAAR,UAAQA,IAAR,CAAaC,OAAb,UAAaA,OAAb,CAEA,GAAMC,QAAO,4FAAG,wKACWL,MAAK,CAACM,GAAN,CAAU,cAAV,CAA0B,CAC7CC,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,gBAAiB,UAAYJ,IAAI,CAACK,WAF7B,CADoC,CAK7CC,eAAe,CAAE,IAL4B,CAA1B,CADX,QACNC,QADM,eAQZN,OAAO,CAAC,SAAAO,IAAI,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAZ,EACAC,OAAO,CAACC,GAAR,CAAY,0BAAZ,CAAuCH,QAAQ,CAACM,IAAT,CAAcR,WAArD,EACA,sCACOG,IADP,MAEIM,KAAK,CAAEP,QAAQ,CAACM,IAAT,CAAcC,KAFzB,CAGIT,WAAW,CAAEE,QAAQ,CAACM,IAAT,CAAcR,WAH/B,GAKH,CARM,CAAP,CARY,gCAiBLE,QAAQ,CAACM,IAAT,CAAcR,WAjBT,wDAAH,kBAAPH,QAAO,0CAAb,CAmBA,MAAOA,QAAP,CACH,CAvBD,CAyBA,cAAeH,gBAAf"},"metadata":{},"sourceType":"module"}